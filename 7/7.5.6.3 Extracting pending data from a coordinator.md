#7.5.6.3 从协调器提取未决数据
>在G3标准中该部分不相关，也就是未使用

　　在支持信标的PAN中，设备通过检测所接收到的信标帧内容就能判断PAN协调器是否存在有等待发送给它的信息帧，如7.5.4.1节所述。如果信标帧的地址列表字段中包含设备地址，并且macAutoRequest为TRUE，设备的MLME将在CAP期间给协调器发送一个数据请求命令（见7.3.4节），其中帧控制字段的确认请求子字段设置为1。当正在执行主动或被动扫描时收到信标帧是唯一的例外情况。在如下两种情况下，MLME将给协调器发送数据请求命令。第一种就是当MLME收到MLME-POLL.request原语时。第二种，设备可能在请求命令确认后的macRequestWaitTime符号之后发送数据请求命令，如在连接的过程中。如果数据请求命令将被发送给PAN协调器，则省略目标地址信息。

　　如果数据请求命令是由MLME-POLL.request原语引发的，MLME将根据该原语的SecurityLevel,KeyIdMode,KeySource和KeyIndex参数执行数据请求命令中的安全进程，如7.5.8.2.1节所述。否则，MLME将根据macAutoRequestSecurityLevel,macAutoRequestKeyIdMode,macAutoRequestKeySource和macAutoRequestKeyIndex等PIB属性来执行数据请求命令中的安全进程。

　　协调器一旦成功的接收到数据请求命令，它将发送确认帧来确认接收。如果协调器在发送确认帧（见7.5.6.4.2节）之前有足够的时间确定设备是否有未决帧，它将把该确认帧的帧控制字段中的帧未决子字段作相应设置，以表示有一个未决的设备帧。如果没有，协调器将把该确认帧的帧未决子字段设置为1。

　　当收到帧未决子字段设置为0的确认帧时，设备将认为在协调器中没有未决数据。

　　在支持信标的PAN中，当收到帧未决子字段设置为1的确认帧时，设备将开启它的接收机，其接收时间最多为macMaxFrameTotalWaitTime个CAP符号时间。在不支持信标的PAN中，当收到帧未决子字段设置为1的确认帧时，设备打开接收机，接受协调器发来的相应数据帧。如果在协调器内存在有发送请求设备的未决数据帧时，协调器将使用下面介绍的机制之一给设备发送帧。如果不存在请求设备的未决数据帧，协调器将给设备发送不带请求确认的数据帧，帧中所包含的有效载荷长度为零，表示没有数据，其发送机制如下所述。

　　在数据请求命令确认之后发送数据帧，将使用下面所述的一个发送机制：

　　——如果在aTurnaroundTime和(aTurnaroundTime+aUnitBackoffPeriod)符号之间，在退避时隙的边界，MAC层能够开始数据帧的发送，并且在竞争期中还有留给消息，适当的帧间隔和确认帧的剩余时间，则不使用CSMA-CA机制。如果在此数据帧之后没有收到请求的确认帧，则该过程将在收到新的数据请求命令之后重新开始。常量aTurnaroundTime在6.4.1中定义。

　　——其它情况都采用CSMA-CA机制。

　　如果在支持信标的PAN中，在macMaxFrameTotalWaitTime个CAP符号时间内，或者在不支持信标的PAN中，数个符号内，请求设备没有收到协调器发来的数据帧，或者收到一个数据帧有效载荷长度为零的数据帧，它将认为协调器中没有未决数据。如果请求设备收到来自协调器的数据帧，如果需要，它将发送一个确认帧来确认接收。

　　如果收到的协调器发来的数据帧的帧控制字段中的帧未决子字段设置为1，则表明在协调器中还有更多的未决数据。在这种情况下，设备可通过给协调器发送一个新的数据请求命令来提取数据。
